<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mediclub - FarmaBien Doctor Loyalty Program</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2a5c8d;
            --secondary: #4caf50;
            --accent: #ff9800;
            --light: #f5f5f5;
            --dark: #333;
            --gray: #757575;
            --light-gray: #e0e0e0;
            --white: #ffffff;
            --danger: #e53935;
            --success: #43a047;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background-color: var(--white);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo img {
            height: 50px;
            margin-right: 10px;
        }

        .logo-text h1 {
            color: var(--primary);
            font-size: 1.5rem;
            font-weight: 700;
        }

        .logo-text p {
            color: var(--gray);
            font-size: 0.8rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: var(--white);
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
            font-weight: bold;
        }

        .user-info h4 {
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .user-info p {
            font-size: 0.7rem;
            color: var(--gray);
        }

        .main-content {
            display: flex;
            min-height: calc(100vh - 82px);
        }

        .sidebar {
            width: 250px;
            background-color: var(--white);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px 0;
            transition: all 0.3s ease;
        }

        .sidebar-menu {
            list-style: none;
        }

        .menu-item {
            margin-bottom: 5px;
        }

        .menu-link {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--dark);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .menu-link:hover, .menu-link.active {
            background-color: rgba(42, 92, 141, 0.1);
            border-left: 3px solid var(--primary);
            color: var(--primary);
        }

        .menu-link i {
            margin-right: 10px;
            font-size: 1.1rem;
        }

        .content-area {
            flex: 1;
            padding: 30px;
            background-color: var(--light);
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .page-title h2 {
            color: var(--primary);
            font-size: 1.8rem;
            font-weight: 600;
        }

        .page-title p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: var(--white);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
        }

        .stat-card.primary::before {
            background-color: var(--primary);
        }

        .stat-card.secondary::before {
            background-color: var(--secondary);
        }

        .stat-card.accent::before {
            background-color: var(--accent);
        }

        .stat-card.danger::before {
            background-color: var(--danger);
        }

        .stat-card .stat-title {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .stat-card .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-card .stat-change {
            font-size: 0.8rem;
            display: flex;
            align-items: center;
        }

        .stat-card .stat-change.positive {
            color: var(--success);
        }

        .stat-card .stat-change.negative {
            color: var(--danger);
        }

        .tab-container {
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
            overflow: hidden;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--light-gray);
            background-color: var(--white);
        }

        .tab {
            padding: 15px 20px;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray);
            transition: all 0.3s ease;
            position: relative;
        }

        .tab:hover {
            color: var(--primary);
        }

        .tab.active {
            color: var(--primary);
            font-weight: 600;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary);
        }

        .tab-content {
            padding: 20px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            margin-bottom: 20px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--light-gray);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }

        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn i {
            margin-right: 5px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background-color: #1d4b7a;
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: var(--white);
        }

        .btn-secondary:hover {
            background-color: #3d8b40;
        }

        .btn-accent {
            background-color: var(--accent);
            color: var(--white);
        }

        .btn-accent:hover {
            background-color: #e68a00;
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: rgba(42, 92, 141, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(42, 92, 141, 0.2);
        }

        .textarea-control {
            min-height: 120px;
            resize: vertical;
        }

        .qr-code-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-color: var(--light);
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .qr-code {
            width: 200px;
            height: 200px;
            background-color: var(--white);
            padding: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid var(--light-gray);
        }

        .qr-code img {
            max-width: 100%;
            max-height: 100%;
        }

        .qr-actions {
            display: flex;
            gap: 10px;
        }

        .table-responsive {
            overflow-x: auto;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th, .table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--light-gray);
        }

        .table th {
            background-color: rgba(42, 92, 141, 0.1);
            color: var(--primary);
            font-weight: 600;
        }

        .table tr:hover {
            background-color: rgba(42, 92, 141, 0.05);
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-primary {
            background-color: rgba(42, 92, 141, 0.1);
            color: var(--primary);
        }

        .badge-secondary {
            background-color: rgba(76, 175, 80, 0.1);
            color: var(--secondary);
        }

        .badge-accent {
            background-color: rgba(255, 152, 0, 0.1);
            color: var(--accent);
        }

        .badge-success {
            background-color: rgba(67, 160, 71, 0.1);
            color: var(--success);
        }

        .badge-danger {
            background-color: rgba(229, 57, 53, 0.1);
            color: var(--danger);
        }

        .membership-levels {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .membership-card {
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 20px;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--light-gray);
            transition: all 0.3s ease;
        }

        .membership-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .membership-card.current {
            border: 2px solid var(--primary);
        }

        .membership-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--light-gray);
        }

        .membership-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .membership-level {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .membership-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .membership-status.current {
            background-color: var(--primary);
            color: var(--white);
        }

        .membership-status.locked {
            background-color: var(--light-gray);
            color: var(--gray);
        }

        .membership-benefits {
            margin-bottom: 20px;
        }

        .benefit-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .benefit-item i {
            margin-right: 10px;
            color: var(--secondary);
        }

        .membership-footer {
            text-align: center;
        }

        .progress-container {
            margin: 30px 0;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .progress-title {
            font-weight: 500;
        }

        .progress-percent {
            font-weight: 600;
            color: var(--primary);
        }

        .progress-bar {
            height: 10px;
            background-color: var(--light-gray);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary);
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .product-card {
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .product-image {
            height: 180px;
            background-color: var(--light-gray);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .product-image img {
            max-width: 80%;
            max-height: 80%;
        }

        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--danger);
            color: var(--white);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .product-content {
            padding: 15px;
        }

        .product-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .product-category {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .product-price {
            display: flex;
            flex-direction: column;
            margin-bottom: 15px;
        }

        .price-retail {
            font-size: 0.9rem;
            color: var(--gray);
            text-decoration: line-through;
        }

        .price-discount {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
        }

        .price-doctor {
            font-size: 0.9rem;
            color: var(--secondary);
        }

        .product-actions {
            display: flex;
            justify-content: space-between;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.8rem;
        }

        .prescription-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .prescription-items {
            grid-column: span 2;
        }

        .prescription-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 50px;
            gap: 10px;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--light-gray);
        }

        .prescription-item:last-child {
            border-bottom: none;
        }

        .add-item-btn {
            grid-column: span 2;
            margin-top: 10px;
        }

        .remove-item {
            color: var(--danger);
            cursor: pointer;
            text-align: center;
        }

        .signature-pad {
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .signature-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .signature-preview {
            margin-top: 20px;
            padding: 10px;
            border: 1px dashed var(--light-gray);
            display: none;
        }

        .signature-preview img {
            max-width: 200px;
        }

        footer {
            background-color: var(--dark);
            color: var(--white);
            padding: 30px 0;
            margin-top: 50px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
        }

        .footer-column h3 {
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: var(--white);
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column li {
            margin-bottom: 8px;
        }

        .footer-column a {
            color: var(--light-gray);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-column a:hover {
            color: var(--white);
        }

        .copyright {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            color: var(--light-gray);
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--success);
            color: white;
            padding: 15px 20px;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        /* Theme selector */
        .theme-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .theme-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .theme-option.selected {
            border-color: var(--dark);
        }

        /* Responsive styles */
        @media (max-width: 992px) {
            .main-content {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                padding: 10px 0;
            }

            .sidebar-menu {
                display: flex;
                overflow-x: auto;
                padding: 0 10px;
            }

            .menu-item {
                margin-bottom: 0;
                margin-right: 5px;
                white-space: nowrap;
            }

            .menu-link {
                padding: 10px 15px;
                border-left: none;
                border-bottom: 3px solid transparent;
            }

            .menu-link:hover, .menu-link.active {
                border-left: none;
                border-bottom: 3px solid var(--primary);
            }

            .content-area {
                padding: 20px;
            }

            .prescription-form {
                grid-template-columns: 1fr;
            }

            .prescription-items {
                grid-column: span 1;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .logo {
                margin-bottom: 15px;
                justify-content: center;
            }

            .user-profile {
                justify-content: center;
            }

            .stats-cards {
                grid-template-columns: 1fr 1fr;
            }

            .page-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .page-actions {
                margin-top: 15px;
                width: 100%;
            }

            .btn {
                width: 100%;
                margin-bottom: 10px;
            }

            .tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }

            .tab {
                white-space: nowrap;
            }

            .prescription-item {
                grid-template-columns: 1fr;
                gap: 5px;
            }

            .remove-item {
                text-align: left;
            }
        }

        @media (max-width: 576px) {
            .stats-cards {
                grid-template-columns: 1fr;
            }

            .membership-levels {
                grid-template-columns: 1fr;
            }

            .product-grid {
                grid-template-columns: 1fr;
            }

            .qr-actions {
                flex-direction: column;
                width: 100%;
            }

            .qr-actions .btn {
                width: 100%;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <img src="https://via.placeholder.com/50x50" alt="FarmaBien Logo">
                    <div class="logo-text">
                        <h1>Mediclub</h1>
                        <p>Doctor Loyalty Program</p>
                    </div>
                </div>
                <div class="user-profile">
                    <div class="user-avatar">JD</div>
                    <div class="user-info">
                        <h4>Dr. Juan Díaz</h4>
                        <p>Cardiología - Nivel Pro</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="main-content">
        <div class="sidebar">
            <ul class="sidebar-menu">
                <li class="menu-item">
                    <a href="#" class="menu-link active" data-tab="dashboard">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-tab="qr-generator">
                        <i class="fas fa-qrcode"></i> Generar QR Pacientes
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-tab="prescriptions">
                        <i class="fas fa-prescription-bottle-alt"></i> Recetas Digitales
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-tab="store">
                        <i class="fas fa-store"></i> Tienda Virtual
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-tab="referrals">
                        <i class="fas fa-user-plus"></i> Referir Médicos
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-tab="membership">
                        <i class="fas fa-award"></i> Mi Membresía
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-tab="account">
                        <i class="fas fa-user-cog"></i> Mi Cuenta
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-tab="settings">
                        <i class="fas fa-cog"></i> Configuración
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" data-tab="help">
                        <i class="fas fa-question-circle"></i> Ayuda
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#" class="menu-link" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                    </a>
                </li>
            </ul>
        </div>

        <div class="content-area">
            <!-- Dashboard Tab -->
            <div class="tab-content active" id="dashboard">
                <div class="page-header">
                    <div class="page-title">
                        <h2>Dashboard</h2>
                        <p>Resumen de tu actividad en Mediclub</p>
                    </div>
                    <div class="page-actions">
                        <button class="btn btn-primary">
                            <i class="fas fa-qrcode"></i> Mi QR Personal
                        </button>
                    </div>
                </div>

                <div class="stats-cards" id="stats-cards">
                    <!-- Stats will be populated by JavaScript -->
                </div>

                <div class="tab-container">
                    <div class="tabs">
                        <div class="tab active" data-tab="activity">Actividad Reciente</div>
                        <div class="tab" data-tab="patients">Pacientes</div>
                        <div class="tab" data-tab="products">Productos Populares</div>
                    </div>
                    <div class="tab-content active" id="activity">
                        <div class="table-responsive">
                            <table class="table" id="activity-table">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Actividad</th>
                                        <th>Detalles</th>
                                        <th>Tokens</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Activity data will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="tab-content" id="patients">
                        <div class="table-responsive">
                            <table class="table" id="patients-table">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Contacto</th>
                                        <th>Última Visita</th>
                                        <th>Compras</th>
                                        <th>Tokens</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Patients data will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="tab-content" id="products">
                        <div class="table-responsive">
                            <table class="table" id="products-table">
                                <thead>
                                    <tr>
                                        <th>Producto</th>
                                        <th>Categoría</th>
                                        <th>Veces Recetado</th>
                                        <th>Pacientes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Products data will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QR Generator Tab -->
            <div class="tab-content" id="qr-generator">
                <div class="page-header">
                    <div class="page-title">
                        <h2>Generar QR para Pacientes</h2>
                        <p>Crea códigos QR de descuento para tus pacientes</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Nuevo Código QR</div>
                    </div>
                    <div class="card-body">
                        <div class="qr-code-container">
                            <div class="qr-code" id="qr-code-display">
                                <img src="" alt="QR Code" id="qr-code-image">
                            </div>
                            <p id="qr-description">Este código QR proporciona un 5% de descuento a tu paciente</p>
                            <div class="qr-actions">
                                <button class="btn btn-primary" id="send-email-btn">
                                    <i class="fas fa-envelope"></i> Enviar por Email
                                </button>
                                <button class="btn btn-secondary" id="send-whatsapp-btn">
                                    <i class="fab fa-whatsapp"></i> Enviar por WhatsApp
                                </button>
                                <button class="btn btn-outline" id="download-qr-btn">
                                    <i class="fas fa-download"></i> Descargar
                                </button>
                            </div>
                        </div>

                        <form id="qr-generator-form">
                            <div class="form-group">
                                <label class="form-label" for="patient-name">Nombre del Paciente</label>
                                <input type="text" class="form-control" id="patient-name" placeholder="Ingrese el nombre del paciente" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="patient-email">Email del Paciente</label>
                                <input type="email" class="form-control" id="patient-email" placeholder="Ingrese el email del paciente">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="patient-phone">Teléfono del Paciente</label>
                                <input type="tel" class="form-control" id="patient-phone" placeholder="Ingrese el teléfono del paciente">
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-qrcode"></i> Generar Nuevo QR
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Historial de Códigos QR Generados</div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="qr-history-table">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Paciente</th>
                                        <th>Contacto</th>
                                        <th>Estado</th>
                                        <th>Token</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- QR history will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Prescriptions Tab -->
            <div class="tab-content" id="prescriptions">
                <div class="page-header">
                    <div class="page-title">
                        <h2>Recetas Digitales</h2>
                        <p>Crea y gestiona recetas digitales para tus pacientes</p>
                    </div>
                    <div class="page-actions">
                        <button class="btn btn-primary" id="new-prescription-btn">
                            <i class="fas fa-plus"></i> Nueva Receta
                        </button>
                    </div>
                </div>

                <div class="card" id="prescription-list">
                    <div class="card-header">
                        <div class="card-title">Mis Recetas</div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="prescriptions-table">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>N° Receta</th>
                                        <th>Paciente</th>
                                        <th>Productos</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Prescriptions will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card" id="new-prescription" style="display: none;">
                    <div class="card-header">
                        <div class="card-title">Nueva Receta Digital</div>
                    </div>
                    <div class="card-body">
                        <form id="prescription-form">
                            <div class="prescription-form">
                                <div class="form-group">
                                    <label class="form-label" for="prescription-patient-name">Nombre del Paciente</label>
                                    <input type="text" class="form-control" id="prescription-patient-name" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="patient-id">Cédula del Paciente</label>
                                    <input type="text" class="form-control" id="patient-id">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="prescription-patient-email">Email del Paciente</label>
                                    <input type="email" class="form-control" id="prescription-patient-email">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="prescription-patient-phone">Teléfono del Paciente</label>
                                    <input type="tel" class="form-control" id="prescription-patient-phone" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="pharmacy">Farmacia Preferida</label>
                                    <select class="form-control" id="pharmacy">
                                        <option value="">Seleccione una farmacia</option>
                                        <option value="1">FarmaBien Las Mercedes</option>
                                        <option value="2">FarmaBien Chacao</option>
                                        <option value="3">FarmaBien La Castellana</option>
                                        <option value="4">FarmaBien El Hatillo</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="diagnosis">Diagnóstico (CIE-10)</label>
                                    <input type="text" class="form-control" id="diagnosis" placeholder="Código CIE-10">
                                </div>

                                <div class="prescription-items" id="prescription-items-container">
                                    <div class="card-header">
                                        <div class="card-title">Medicamentos</div>
                                    </div>
                                    <div class="prescription-item">
                                        <select class="form-control" name="medication" required>
                                            <option value="">Seleccione medicamento</option>
                                            <option value="1">Atorvastatina 20mg</option>
                                            <option value="2">Losartán 50mg</option>
                                            <option value="3">Metformina 850mg</option>
                                            <option value="4">Omeprazol 20mg</option>
                                            <option value="5">Amlodipino 5mg</option>
                                        </select>
                                        <input type="text" class="form-control" name="dosage" placeholder="Dosis" required>
                                        <input type="text" class="form-control" name="frequency" placeholder="Frecuencia" required>
                                        <input type="text" class="form-control" name="duration" placeholder="Duración" required>
                                        <div class="remove-item">
                                            <i class="fas fa-times"></i>
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-outline add-item-btn" id="add-prescription-item">
                                        <i class="fas fa-plus"></i> Añadir Medicamento
                                    </button>
                                </div>

                                <div class="form-group">
                                    <label class="form-label" for="instructions">Instrucciones Médicas</label>
                                    <textarea class="form-control textarea-control" id="instructions" rows="3"></textarea>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Firma Digital</label>
                                    <div class="signature-pad" id="signature-pad">
                                        <canvas width="400" height="200" style="border: 1px solid #ccc;"></canvas>
                                    </div>
                                    <div class="signature-actions">
                                        <button type="button" class="btn btn-outline" id="clear-signature">
                                            <i class="fas fa-eraser"></i> Limpiar
                                        </button>
                                        <button type="button" class="btn btn-outline" id="save-signature">
                                            <i class="fas fa-save"></i> Guardar Firma
                                        </button>
                                    </div>
                                    <div class="signature-preview" id="signature-preview">
                                        <p>Firma guardada:</p>
                                        <img src="" alt="Firma digital">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane"></i> Enviar Receta
                                    </button>
                                    <button type="button" class="btn btn-outline" id="cancel-prescription">
                                        Cancelar
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Store Tab -->
            <div class="tab-content" id="store">
                <div class="page-header">
                    <div class="page-title">
                        <h2>Tienda Virtual</h2>
                        <p>Productos disponibles con precios especiales para médicos</p>
                    </div>
                    <div class="page-actions">
                        <div class="form-group" style="margin-bottom: 0;">
                            <input type="text" class="form-control" id="product-search" placeholder="Buscar productos..." style="min-width: 250px;">
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Filtros</div>
                    </div>
                    <div class="card-body">
                        <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                            <div class="form-group" style="min-width: 200px;">
                                <label class="form-label">Categoría</label>
                                <select class="form-control" id="product-category">
                                    <option value="">Todas las categorías</option>
                                    <option value="Cardiovascular">Cardiovascular</option>
                                    <option value="Hipertensión">Hipertensión</option>
                                    <option value="Diabetes">Diabetes</option>
                                    <option value="Gastrointestinal">Gastrointestinal</option>
                                    <option value="Analgésicos">Analgésicos</option>
                                </select>
                            </div>
                            <div class="form-group" style="min-width: 200px;">
                                <label class="form-label">Ordenar por</label>
                                <select class="form-control" id="product-sort">
                                    <option value="popular">Más populares</option>
                                    <option value="price-low">Precio (menor a mayor)</option>
                                    <option value="price-high">Precio (mayor a menor)</option>
                                    <option value="name-asc">Nombre (A-Z)</option>
                                    <option value="name-desc">Nombre (Z-A)</option>
                                </select>
                            </div>
                            <div class="form-group" style="min-width: 200px;">
                                <label class="form-label">Farmacia</label>
                                <select class="form-control" id="product-pharmacy">
                                    <option value="">Todas las farmacias</option>
                                    <option value="FarmaBien Las Mercedes">FarmaBien Las Mercedes</option>
                                    <option value="FarmaBien Chacao">FarmaBien Chacao</option>
                                    <option value="FarmaBien La Castellana">FarmaBien La Castellana</option>
                                    <option value="FarmaBien El Hatillo">FarmaBien El Hatillo</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="product-grid" id="product-grid">
                    <!-- Products will be populated by JavaScript -->
                </div>
            </div>

            <!-- Referrals Tab -->
            <div class="tab-content" id="referrals">
                <div class="page-header">
                    <div class="page-title">
                        <h2>Referir Médicos</h2>
                        <p>Invita a colegas a unirse a Mediclub y gana tokens</p>
                    </div>
                    <div class="page-actions">
                        <button class="btn btn-primary" id="invite-doctor-btn">
                            <i class="fas fa-user-plus"></i> Invitar Médico
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Mi Código de Referido</div>
                    </div>
                    <div class="card-body">
                        <div class="qr-code-container">
                            <div class="qr-code">
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=https://farmabien.com/mediclub/ref/JD123456" alt="Referral QR Code" id="referral-qr-code">
                            </div>
                            <p>Este código QR único permite a otros médicos registrarse bajo tu referencia</p>
                            <div class="form-group">
                                <label class="form-label">Enlace de Referido</label>
                                <div style="display: flex;">
                                    <input type="text" class="form-control" id="referral-link" value="https://farmabien.com/mediclub/ref/JD123456" readonly style="border-top-right-radius: 0; border-bottom-right-radius: 0;">
                                    <button class="btn btn-primary" id="copy-referral-link" style="border-top-left-radius: 0; border-bottom-left-radius: 0;">
                                        <i class="fas fa-copy"></i> Copiar
                                    </button>
                                </div>
                            </div>
                            <div class="qr-actions">
                                <button class="btn btn-primary" id="send-referral-email">
                                    <i class="fas fa-envelope"></i> Enviar por Email
                                </button>
                                <button class="btn btn-secondary" id="send-referral-whatsapp">
                                    <i class="fab fa-whatsapp"></i> Enviar por WhatsApp
                                </button>
                                <button class="btn btn-outline" id="download-referral-qr">
                                    <i class="fas fa-download"></i> Descargar QR
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Médicos Referidos</div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table" id="referred-doctors-table">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Especialidad</th>
                                        <th>Fecha Registro</th>
                                        <th>Estado</th>
                                        <th>Tokens</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Referred doctors will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">¿Cómo funciona?</div>
                    </div>
                    <div class="card-body">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div>
                                <h4 style="margin-bottom: 10px; color: var(--primary);">1. Invita a tus colegas</h4>
                                <p>Comparte tu enlace o código QR único con otros médicos para que se registren en Mediclub.</p>
                            </div>
                            <div>
                                <h4 style="margin-bottom: 10px; color: var(--primary);">2. Ellos se registran</h4>
                                <p>Los médicos referidos deben completar su registro y activar su cuenta.</p>
                            </div>
                            <div>
                                <h4 style="margin-bottom: 10px; color: var(--primary);">3. Gana tokens</h4>
                                <p>Recibirás 10-15 tokens por cada médico que se registre y active su cuenta a través de tu referencia.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Membership Tab -->
            <div class="tab-content" id="membership">
                <div class="page-header">
                    <div class="page-title">
                        <h2>Mi Membresía</h2>
                        <p>Beneficios y progreso en el programa Mediclub</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Mi Nivel Actual</div>
                    </div>
                    <div class="card-body">
                        <div class="membership-levels" id="membership-levels">
                            <!-- Membership levels will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Mi Progreso</div>
                    </div>
                    <div class="card-body">
                        <div class="progress-container">
                            <div class="progress-header">
                                <div class="progress-title">Pacientes referidos este mes</div>
                                <div class="progress-percent" id="patients-progress">0/20 (0%)</div>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="patients-progress-bar" style="width: 0%;"></div>
                            </div>
                        </div>

                        <div class="progress-container">
                            <div class="progress-header">
                                <div class="progress-title">Médicos referidos (total)</div>
                                <div class="progress-percent" id="doctors-progress">0/5 (0%)</div>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="doctors-progress-bar" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Mis Tokens</div>
                    </div>
                    <div class="card-body">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <div>
                                <h3 style="color: var(--primary); margin-bottom: 5px;"><span id="token-balance">0</span> Tokens</h3>
                                <p style="color: var(--gray);">1 Token = $1 USD en productos</p>
                            </div>
                            <button class="btn btn-primary" id="redeem-tokens-btn">
                                <i class="fas fa-exchange-alt"></i> Canjear Tokens
                            </button>
                        </div>

                        <div class="table-responsive">
                            <table class="table" id="token-history-table">
                                <thead>
                                    <tr>
                                        <th>Fecha</th>
                                        <th>Descripción</th>
                                        <th>Tokens</th>
                                        <th>Saldo</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Token history will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Account Tab -->
            <div class="tab-content" id="account">
                <div class="page-header">
                    <div class="page-title">
                        <h2>Mi Cuenta</h2>
                        <p>Administra tu perfil y configuración</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Información Personal</div>
                    </div>
                    <div class="card-body">
                        <form id="account-form">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <div class="form-group">
                                    <label class="form-label" for="first-name">Nombres</label>
                                    <input type="text" class="form-control" id="first-name" value="Juan">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="last-name">Apellidos</label>
                                    <input type="text" class="form-control" id="last-name" value="Díaz">
                                </div>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <div class="form-group">
                                    <label class="form-label" for="id-number">Cédula Profesional</label>
                                    <input type="text" class="form-control" id="id-number" value="JD123456">
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="specialty">Especialidad</label>
                                    <input type="text" class="form-control" id="specialty" value="Cardiología">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="email">Email</label>
                                <input type="email" class="form-control" id="email" value="juan.diaz@email.com">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="phone">Teléfono</label>
                                <input type="tel" class="form-control" id="phone" value="+58 412 5557890">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="address">Dirección</label>
                                <input type="text" class="form-control" id="address" value="Av. Principal, Caracas">
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Guardar Cambios
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Seguridad</div>
                    </div>
                    <div class="card-body">
                        <form id="security-form">
                            <div class="form-group">
                                <label class="form-label" for="current-password">Contraseña Actual</label>
                                <input type="password" class="form-control" id="current-password">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="new-password">Nueva Contraseña</label>
                                <input type="password" class="form-control" id="new-password">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="confirm-password">Confirmar Nueva Contraseña</label>
                                <input type="password" class="form-control" id="confirm-password">
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-key"></i> Cambiar Contraseña
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Mi QR Personal</div>
                    </div>
                    <div class="card-body">
                        <div class="qr-code-container">
                            <div class="qr-code">
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=https://farmabien.com/mediclub/doc/JD123456" alt="Personal QR Code" id="personal-qr-code">
                            </div>
                            <p>Este es tu código QR personal para compras al costo en FarmaBien</p>
                            <div class="qr-actions">
                                <button class="btn btn-outline" id="download-personal-qr">
                                    <i class="fas fa-download"></i> Descargar
                                </button>
                                <button class="btn btn-primary" id="print-personal-qr">
                                    <i class="fas fa-print"></i> Imprimir
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content" id="settings">
                <div class="page-header">
                    <div class="page-title">
                        <h2>Configuración</h2>
                        <p>Personaliza tu experiencia en Mediclub</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Preferencias de Tema</div>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Color Principal</label>
                            <div class="theme-selector">
                                <div class="theme-option selected" style="background-color: #2a5c8d;" data-color="#2a5c8d"></div>
                                <div class="theme-option" style="background-color: #3f51b5;" data-color="#3f51b5"></div>
                                <div class="theme-option" style="background-color: #9c27b0;" data-color="#9c27b0"></div>
                                <div class="theme-option" style="background-color: #e91e63;" data-color="#e91e63"></div>
                                <div class="theme-option" style="background-color: #f44336;" data-color="#f44336"></div>
                                <div class="theme-option" style="background-color: #ff5722;" data-color="#ff5722"></div>
                                <div class="theme-option" style="background-color: #795548;" data-color="#795548"></div>
                                <div class="theme-option" style="background-color: #607d8b;" data-color="#607d8b"></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Modo Oscuro</label>
                            <div>
                                <label class="switch">
                                    <input type="checkbox" id="dark-mode-toggle">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Notificaciones</div>
                    </div>
                    <div class="card-body">
                        <form id="notifications-form">
                            <div class="form-group">
                                <label class="form-label">Recibir notificaciones por:</label>
                                <div>
                                    <label class="checkbox-container">
                                        <input type="checkbox" id="email-notifications" checked>
                                        <span class="checkmark"></span> Email
                                    </label>
                                    <label class="checkbox-container">
                                        <input type="checkbox" id="sms-notifications">
                                        <span class="checkmark"></span> SMS
                                    </label>
                                    <label class="checkbox-container">
                                        <input type="checkbox" id="push-notifications" checked>
                                        <span class="checkmark"></span> Notificaciones push
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Tipos de notificaciones:</label>
                                <div>
                                    <label class="checkbox-container">
                                        <input type="checkbox" id="notif-tokens" checked>
                                        <span class="checkmark"></span> Actividad de tokens
                                    </label>
                                    <label class="checkbox-container">
                                        <input type="checkbox" id="notif-referrals" checked>
                                        <span class="checkmark"></span> Referidos
                                    </label>
                                    <label class="checkbox-container">
                                        <input type="checkbox" id="notif-prescriptions" checked>
                                        <span class="checkmark"></span> Recetas digitales
                                    </label>
                                    <label class="checkbox-container">
                                        <input type="checkbox" id="notif-promotions" checked>
                                        <span class="checkmark"></span> Promociones
                                    </label>
                                </div>
                            </div>

                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Guardar Configuración
                            </button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Privacidad</div>
                    </div>
                    <div class="card-body">
                        <form id="privacy-form">
                            <div class="form-group">
                                <label class="form-label">Mostrar mi perfil en el directorio médico:</label>
                                <div>
                                    <label class="radio-container">
                                        <input type="radio" name="profile-visibility" value="public" checked>
                                        <span class="radiomark"></span> Público
                                    </label>
                                    <label class="radio-container">
                                        <input type="radio" name="profile-visibility" value="private">
                                        <span class="radiomark"></span> Privado
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Compartir mis estadísticas con FarmaBien para mejorar el programa:</label>
                                <div>
                                    <label class="radio-container">
                                        <input type="radio" name="data-sharing" value="yes" checked>
                                        <span class="radiomark"></span> Sí
                                    </label>
                                    <label class="radio-container">
                                        <input type="radio" name="data-sharing" value="no">
                                        <span class="radiomark"></span> No
                                    </label>
                                </div>
                            </div>

                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Guardar Configuración
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Help Tab -->
            <div class="tab-content" id="help">
                <div class="page-header">
                    <div class="page-title">
                        <h2>Centro de Ayuda</h2>
                        <p>Encuentra respuestas a tus preguntas sobre Mediclub</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Preguntas Frecuentes</div>
                    </div>
                    <div class="card-body">
                        <div class="accordion" id="faq-accordion">
                            <!-- FAQ items will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Contactar Soporte</div>
                    </div>
                    <div class="card-body">
                        <form id="help-form">
                            <div class="form-group">
                                <label class="form-label" for="help-subject">Asunto</label>
                                <select class="form-control" id="help-subject">
                                    <option value="">Seleccione un asunto</option>
                                    <option value="1">Problemas con la cuenta</option>
                                    <option value="2">Preguntas sobre tokens</option>
                                    <option value="3">Problemas con recetas digitales</option>
                                    <option value="4">Problemas con códigos QR</option>
                                    <option value="5">Otro</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="help-message">Mensaje</label>
                                <textarea class="form-control textarea-control" id="help-message" rows="5"></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> Enviar Mensaje
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Mediclub</h3>
                    <ul>
                        <li><a href="#">Acerca del Programa</a></li>
                        <li><a href="#">Beneficios</a></li>
                        <li><a href="#">Niveles de Membresía</a></li>
                        <li><a href="#">Preguntas Frecuentes</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>FarmaBien</h3>
                    <ul>
                        <li><a href="#">Nuestras Farmacias</a></li>
                        <li><a href="#">Productos</a></li>
                        <li><a href="#">Servicios</a></li>
                        <li><a href="#">Contacto</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Recursos</h3>
                    <ul>
                        <li><a href="#">Guía de Uso</a></li>
                        <li><a href="#">Tutoriales</a></li>
                        <li><a href="#">Documentación</a></li>
                        <li><a href="#">Políticas de Privacidad</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contacto</h3>
                    <ul>
                        <li><i class="fas fa-phone"></i> +58 212 555 1234</li>
                        <li><i class="fas fa-envelope"></i> mediclub@farmabien.com</li>
                        <li><i class="fas fa-map-marker-alt"></i> Av. Principal, Caracas, Venezuela</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 FarmaBien Mediclub. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <div class="toast" id="toast"></div>

    <script>
        // Data Models
        const appData = {
            user: {
                id: 'JD123456',
                firstName: 'Juan',
                lastName: 'Díaz',
                specialty: 'Cardiología',
                email: 'juan.diaz@email.com',
                phone: '+58 412 5557890',
                address: 'Av. Principal, Caracas',
                membershipLevel: 'Pro',
                tokens: 145,
                referredPatients: 28,
                referredDoctors: 3,
                prescriptions: 42,
                signature: null
            },
            settings: {
                themeColor: '#2a5c8d',
                darkMode: false,
                notifications: {
                    email: true,
                    sms: false,
                    push: true,
                    tokens: true,
                    referrals: true,
                    prescriptions: true,
                    promotions: true
                },
                privacy: {
                    profileVisibility: 'public',
                    dataSharing: 'yes'
                }
            },
            activityLog: [
                { date: '15/06/2023', activity: 'Paciente referido', details: 'María González', tokens: 1 },
                { date: '14/06/2023', activity: 'Receta digital', details: 'Atorvastatina 20mg', tokens: 0 },
                { date: '12/06/2023', activity: 'Compra en farmacia', details: 'FarmaBien Las Mercedes', tokens: 0 },
                { date: '10/06/2023', activity: 'Médico referido', details: 'Dra. Laura Pérez', tokens: 10 },
                { date: '08/06/2023', activity: 'Paciente referido', details: 'Carlos Rodríguez', tokens: 1 }
            ],
            patients: [
                { name: 'María González', contact: 'maria@email.com', lastVisit: '15/06/2023', purchases: 3, tokens: 3 },
                { name: 'Carlos Rodríguez', contact: '+58 412 5551234', lastVisit: '08/06/2023', purchases: 1, tokens: 1 },
                { name: 'Ana Martínez', contact: 'ana@email.com', lastVisit: '02/06/2023', purchases: 5, tokens: 5 },
                { name: 'Luis Hernández', contact: '+58 414 5556789', lastVisit: '28/05/2023', purchases: 2, tokens: 2 }
            ],
            popularProducts: [
                { name: 'Atorvastatina 20mg', category: 'Cardiovascular', prescriptions: 12, patients: 8 },
                { name: 'Losartán 50mg', category: 'Hipertensión', prescriptions: 9, patients: 6 },
                { name: 'Metformina 850mg', category: 'Diabetes', prescriptions: 7, patients: 5 },
                { name: 'Omeprazol 20mg', category: 'Gastrointestinal', prescriptions: 6, patients: 4 },
                { name: 'Amlodipino 5mg', category: 'Hipertensión', prescriptions: 5, patients: 4 }
            ],
            qrHistory: [
                { date: '15/06/2023', patient: 'María González', contact: 'maria@email.com', status: 'Usado', token: 1 },
                { date: '08/06/2023', patient: 'Carlos Rodríguez', contact: '+58 412 5551234', status: 'Usado', token: 1 },
                { date: '02/06/2023', patient: 'Ana Martínez', contact: 'ana@email.com', status: 'Usado', token: 1 },
                { date: '28/05/2023', patient: 'Luis Hernández', contact: '+58 414 5556789', status: 'Usado', token: 1 },
                { date: '22/05/2023', patient: 'Pedro Sánchez', contact: 'pedro@email.com', status: 'No usado', token: 0 }
            ],
            prescriptions: [
                { date: '14/06/2023', number: 'RX-2023-00042', patient: 'María González', items: 3, status: 'Entregada' },
                { date: '10/06/2023', number: 'RX-2023-00041', patient: 'Carlos Rodríguez', items: 2, status: 'Entregada' },
                { date: '05/06/2023', number: 'RX-2023-00040', patient: 'Ana Martínez', items: 4, status: 'Entregada' },
                { date: '01/06/2023', number: 'RX-2023-00039', patient: 'Luis Hernández', items: 1, status: 'Pendiente' }
            ],
            referredDoctors: [
                { name: 'Dra. Laura Pérez', specialty: 'Pediatría', date: '10/06/2023', status: 'Activo', tokens: 10 },
                { name: 'Dr. Carlos Mendoza', specialty: 'Medicina Interna', date: '28/05/2023', status: 'Activo', tokens: 10 },
                { name: 'Dra. Ana Rodríguez', specialty: 'Ginecología', date: '15/05/2023', status: 'Pendiente', tokens: 0 }
            ],
            tokenHistory: [
                { date: '15/06/2023', description: 'Paciente referido - María González', tokens: 1, balance: 145 },
                { date: '10/06/2023', description: 'Médico referido - Dra. Laura Pérez', tokens: 10, balance: 144 },
                { date: '08/06/2023', description: 'Paciente referido - Carlos Rodríguez', tokens: 1, balance: 134 },
                { date: '05/06/2023', description: 'Canje de productos', tokens: -15, balance: 133 },
                { date: '02/06/2023', description: 'Paciente referido - Ana Martínez', tokens: 1, balance: 148 }
            ],
            membershipLevels: [
                {
                    name: 'Básico',
                    level: 'Nivel 1',
                    status: 'locked',
                    benefits: [
                        'Acceso a precios al costo',
                        'Generación de QR para pacientes',
                        'No tokens por pacientes referidos',
                        'No acceso a eventos exclusivos'
                    ],
                    requirements: 'Registro + referir 1 médico'
                },
                {
                    name: 'Pro',
                    level: 'Nivel 2',
                    status: 'current',
                    benefits: [
                        'Acceso a precios al costo',
                        'Generación de QR para pacientes',
                        'Tokens por pacientes referidos',
                        'Acceso a eventos exclusivos'
                    ],
                    requirements: '20 pacientes/mes + 5 médicos referidos'
                },
                {
                    name: 'Elite',
                    level: 'Nivel 3',
                    status: 'locked',
                    benefits: [
                        'Acceso a precios al costo',
                        'Generación de QR para pacientes',
                        'Tokens por pacientes referidos',
                        'Acceso a eventos exclusivos',
                        'Patrocinio conferencias médicas'
                    ],
                    requirements: '40 pacientes referidos/mes'
                }
            ],
            products: [
                {
                    id: 1,
                    name: 'Atorvastatina 20mg',
                    category: 'Cardiovascular',
                    description: '30 tabletas',
                    retailPrice: 25.00,
                    discountPrice: 22.50,
                    doctorPrice: 18.00,
                    pharmacy: 'FarmaBien Las Mercedes',
                    badge: 'Nuevo'
                },
                {
                    id: 2,
                    name: 'Losartán 50mg',
                    category: 'Hipertensión',
                    description: '30 tabletas',
                    retailPrice: 18.00,
                    discountPrice: 16.20,
                    doctorPrice: 12.50,
                    pharmacy: 'FarmaBien Chacao'
                },
                {
                    id: 3,
                    name: 'Metformina 850mg',
                    category: 'Diabetes',
                    description: '30 tabletas',
                    retailPrice: 12.00,
                    discountPrice: 10.80,
                    doctorPrice: 8.00,
                    pharmacy: 'FarmaBien La Castellana'
                },
                {
                    id: 4,
                    name: 'Omeprazol 20mg',
                    category: 'Gastrointestinal',
                    description: '14 cápsulas',
                    retailPrice: 15.00,
                    discountPrice: 13.50,
                    doctorPrice: 10.00,
                    pharmacy: 'FarmaBien El Hatillo'
                },
                {
                    id: 5,
                    name: 'Amlodipino 5mg',
                    category: 'Hipertensión',
                    description: '30 tabletas',
                    retailPrice: 14.00,
                    discountPrice: 12.60,
                    doctorPrice: 9.00,
                    pharmacy: 'FarmaBien Las Mercedes'
                },
                {
                    id: 6,
                    name: 'Simvastatina 20mg',
                    category: 'Cardiovascular',
                    description: '30 tabletas',
                    retailPrice: 20.00,
                    discountPrice: 18.00,
                    doctorPrice: 14.00,
                    pharmacy: 'FarmaBien Chacao'
                }
            ],
            faqs: [
                {
                    question: '¿Cómo genero códigos QR para mis pacientes?',
                    answer: 'Para generar códigos QR de descuento para tus pacientes:<ol><li>Ve a la sección "Generar QR Pacientes" en el menú.</li><li>Ingresa los datos del paciente (nombre, email y/o teléfono).</li><li>Haz clic en "Generar Nuevo QR".</li><li>Envía el código QR al paciente por email o WhatsApp.</li></ol><p>Cada código QR es de un solo uso y proporciona un 5% de descuento al paciente.</p>'
                },
                {
                    question: '¿Cómo puedo canjear mis tokens?',
                    answer: 'Para canjear tus tokens:<ol><li>Visita cualquier farmacia FarmaBien participante.</li><li>Presenta tu código QR personal al hacer tu compra.</li><li>Informa al personal que deseas canjear tokens.</li><li>Los tokens se aplicarán como descuento en tu compra (1 token = $1 USD).</li></ol><p>También puedes canjear tokens directamente desde la Tienda Virtual seleccionando la opción "Pagar con Tokens".</p>'
                },
                {
                    question: '¿Cómo funciona el sistema de referidos de médicos?',
                    answer: 'El sistema de referidos te permite ganar tokens por invitar a otros médicos a unirse a Mediclub:<ul><li>Comparte tu enlace o código QR único con colegas.</li><li>Cuando un médico se registra usando tu referencia y activa su cuenta, recibirás entre 10-15 tokens.</li><li>El médico referido también recibe 5 tokens de bienvenida.</li><li>Puedes hacer seguimiento de tus referidos en la sección "Referir Médicos".</li></ul>'
                },
                {
                    question: '¿Cómo subo de nivel en el programa Mediclub?',
                    answer: 'El programa Mediclub tiene 3 niveles con beneficios crecientes:<ul><li><strong>Básico:</strong> Al registrarte y referir al menos 1 médico.</li><li><strong>Pro:</strong> Refiriendo 20 pacientes por mes y 5 médicos (una sola vez).</li><li><strong>Elite:</strong> Refiriendo 40 pacientes por mes.</li></ul><p>Tu progreso se actualiza automáticamente y puedes monitorearlo en la sección "Mi Membresía".</p>'
                }
            ]
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Load data from localStorage if available
            loadDataFromStorage();

            // Initialize UI components
            initDashboard();
            initQRGenerator();
            initPrescriptions();
            initStore();
            initReferrals();
            initMembership();
            initAccount();
            initSettings();
            initHelp();

            // Setup event listeners
            setupEventListeners();

            // Apply saved theme
            applyTheme();
        });

        // Data persistence functions
        function saveDataToStorage() {
            localStorage.setItem('mediclubData', JSON.stringify(appData));
        }

        function loadDataFromStorage() {
            const savedData = localStorage.getItem('mediclubData');
            if (savedData) {
                Object.assign(appData, JSON.parse(savedData));
            }
        }

        // UI Initialization functions
        function initDashboard() {
            // Update stats cards
            const statsCards = document.getElementById('stats-cards');
            statsCards.innerHTML = `
                <div class="stat-card primary">
                    <div class="stat-title">Tokens Acumulados</div>
                    <div class="stat-value">${appData.user.tokens}</div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i> ${Math.floor(appData.user.tokens / 10)} este mes
                    </div>
                </div>
                <div class="stat-card secondary">
                    <div class="stat-title">Pacientes Referidos</div>
                    <div class="stat-value">${appData.user.referredPatients}</div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i> ${Math.floor(appData.user.referredPatients / 5)} este mes
                    </div>
                </div>
                <div class="stat-card accent">
                    <div class="stat-title">Médicos Referidos</div>
                    <div class="stat-value">${appData.user.referredDoctors}</div>
                    <div class="stat-change">
                        <i class="fas fa-equals"></i> Sin cambios
                    </div>
                </div>
                <div class="stat-card danger">
                    <div class="stat-title">Recetas Digitales</div>
                    <div class="stat-value">${appData.user.prescriptions}</div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i> ${Math.floor(appData.user.prescriptions / 5)} este mes
                    </div>
                </div>
            `;

            // Populate activity table
            const activityTable = document.querySelector('#activity-table tbody');
            activityTable.innerHTML = appData.activityLog.map(item => `
                <tr>
                    <td>${item.date}</td>
                    <td>${item.activity}</td>
                    <td>${item.details}</td>
                    <td>${item.tokens > 0 ? `<span class="badge badge-success">+${item.tokens}</span>` : '<span class="badge badge-secondary">-</span>'}</td>
                </tr>
            `).join('');

            // Populate patients table
            const patientsTable = document.querySelector('#patients-table tbody');
            patientsTable.innerHTML = appData.patients.map(patient => `
                <tr>
                    <td>${patient.name}</td>
                    <td>${patient.contact}</td>
                    <td>${patient.lastVisit}</td>
                    <td>${patient.purchases}</td>
                    <td><span class="badge badge-success">${patient.tokens}</span></td>
                </tr>
            `).join('');

            // Populate products table
            const productsTable = document.querySelector('#products-table tbody');
            productsTable.innerHTML = appData.popularProducts.map(product => `
                <tr>
                    <td>${product.name}</td>
                    <td>${product.category}</td>
                    <td>${product.prescriptions}</td>
                    <td>${product.patients}</td>
                </tr>
            `).join('');
        }

        function initQRGenerator() {
            // Set up QR code
            updateQRCode('https://farmabien.com/mediclub/desc/5/JD123456');

            // Populate QR history table
            const qrHistoryTable = document.querySelector('#qr-history-table tbody');
            qrHistoryTable.innerHTML = appData.qrHistory.map(item => `
                <tr>
                    <td>${item.date}</td>
                    <td>${item.patient}</td>
                    <td>${item.contact}</td>
                    <td><span class="badge ${item.status === 'Usado' ? 'badge-success' : 'badge-danger'}">${item.status}</span></td>
                    <td><span class="badge ${item.token > 0 ? 'badge-success' : 'badge-danger'}">${item.token > 0 ? '+' + item.token : item.token}</span></td>
                </tr>
            `).join('');
        }

        function initPrescriptions() {
            // Populate prescriptions table
            const prescriptionsTable = document.querySelector('#prescriptions-table tbody');
            prescriptionsTable.innerHTML = appData.prescriptions.map(prescription => `
                <tr>
                    <td>${prescription.date}</td>
                    <td>${prescription.number}</td>
                    <td>${prescription.patient}</td>
                    <td>${prescription.items}</td>
                    <td><span class="badge ${prescription.status === 'Entregada' ? 'badge-success' : 'badge-secondary'}">${prescription.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline view-prescription-btn" data-id="${prescription.number}">
                            <i class="fas fa-eye"></i> Ver
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function initStore() {
            // Populate product grid
            renderProducts(appData.products);

            // Set up search and filter functionality
            document.getElementById('product-search').addEventListener('input', filterProducts);
            document.getElementById('product-category').addEventListener('change', filterProducts);
            document.getElementById('product-sort').addEventListener('change', filterProducts);
            document.getElementById('product-pharmacy').addEventListener('change', filterProducts);
        }

        function initReferrals() {
            // Populate referred doctors table
            const referredDoctorsTable = document.querySelector('#referred-doctors-table tbody');
            referredDoctorsTable.innerHTML = appData.referredDoctors.map(doctor => `
                <tr>
                    <td>${doctor.name}</td>
                    <td>${doctor.specialty}</td>
                    <td>${doctor.date}</td>
                    <td><span class="badge ${doctor.status === 'Activo' ? 'badge-success' : 'badge-secondary'}">${doctor.status}</span></td>
                    <td><span class="badge ${doctor.tokens > 0 ? 'badge-success' : 'badge-danger'}">${doctor.tokens > 0 ? '+' + doctor.tokens : doctor.tokens}</span></td>
                </tr>
            `).join('');
        }

        function initMembership() {
            // Populate membership levels
            const membershipLevels = document.getElementById('membership-levels');
            membershipLevels.innerHTML = appData.membershipLevels.map(level => `
                <div class="membership-card ${level.status === 'current' ? 'current' : ''}">
                    <div class="membership-header">
                        <h3 class="membership-title">${level.name}</h3>
                        <p class="membership-level">${level.level}</p>
                        <span class="membership-status ${level.status}">${level.status === 'current' ? 'Actual' : 'Bloqueado'}</span>
                    </div>
                    <div class="membership-benefits">
                        ${level.benefits.map(benefit => `
                            <div class="benefit-item">
                                <i class="fas ${benefit.startsWith('No ') ? 'fa-times' : 'fa-check'}"></i> ${benefit}
                            </div>
                        `).join('')}
                    </div>
                    <div class="membership-footer">
                        <p>Requisitos:</p>
                        <p>${level.requirements}</p>
                    </div>
                </div>
            `).join('');

            // Update progress bars
            const patientsProgress = Math.min(100, (appData.user.referredPatients / 20) * 100);
            const doctorsProgress = Math.min(100, (appData.user.referredDoctors / 5) * 100);

            document.getElementById('patients-progress').textContent = `${appData.user.referredPatients}/20 (${Math.round(patientsProgress)}%)`;
            document.getElementById('doctors-progress').textContent = `${appData.user.referredDoctors}/5 (${Math.round(doctorsProgress)}%)`;
            document.getElementById('patients-progress-bar').style.width = `${patientsProgress}%`;
            document.getElementById('doctors-progress-bar').style.width = `${doctorsProgress}%`;

            // Update token balance
            document.getElementById('token-balance').textContent = appData.user.tokens;

            // Populate token history
            const tokenHistoryTable = document.querySelector('#token-history-table tbody');
            tokenHistoryTable.innerHTML = appData.tokenHistory.map(item => `
                <tr>
                    <td>${item.date}</td>
                    <td>${item.description}</td>
                    <td><span class="badge ${item.tokens > 0 ? 'badge-success' : 'badge-danger'}">${item.tokens > 0 ? '+' + item.tokens : item.tokens}</span></td>
                    <td>${item.balance}</td>
                </tr>
            `).join('');
        }

        function initAccount() {
            // Populate account form
            document.getElementById('first-name').value = appData.user.firstName;
            document.getElementById('last-name').value = appData.user.lastName;
            document.getElementById('id-number').value = appData.user.id;
            document.getElementById('specialty').value = appData.user.specialty;
            document.getElementById('email').value = appData.user.email;
            document.getElementById('phone').value = appData.user.phone;
            document.getElementById('address').value = appData.user.address;

            // Set up personal QR code
            document.getElementById('personal-qr-code').src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=https://farmabien.com/mediclub/doc/${appData.user.id}`;
        }

        function initSettings() {
            // Set up theme selector
            const themeOptions = document.querySelectorAll('.theme-option');
            themeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    themeOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    appData.settings.themeColor = this.getAttribute('data-color');
                    applyTheme();
                    saveDataToStorage();
                });

                if (option.getAttribute('data-color') === appData.settings.themeColor) {
                    option.classList.add('selected');
                }
            });

            // Set up dark mode toggle
            const darkModeToggle = document.getElementById('dark-mode-toggle');
            darkModeToggle.checked = appData.settings.darkMode;
            darkModeToggle.addEventListener('change', function() {
                appData.settings.darkMode = this.checked;
                applyTheme();
                saveDataToStorage();
            });

            // Set up notification settings
            document.getElementById('email-notifications').checked = appData.settings.notifications.email;
            document.getElementById('sms-notifications').checked = appData.settings.notifications.sms;
            document.getElementById('push-notifications').checked = appData.settings.notifications.push;
            document.getElementById('notif-tokens').checked = appData.settings.notifications.tokens;
            document.getElementById('notif-referrals').checked = appData.settings.notifications.referrals;
            document.getElementById('notif-prescriptions').checked = appData.settings.notifications.prescriptions;
            document.getElementById('notif-promotions').checked = appData.settings.notifications.promotions;

            // Set up privacy settings
            document.querySelector(`input[name="profile-visibility"][value="${appData.settings.privacy.profileVisibility}"]`).checked = true;
            document.querySelector(`input[name="data-sharing"][value="${appData.settings.privacy.dataSharing}"]`).checked = true;
        }

        function initHelp() {
            // Populate FAQ accordion
            const faqAccordion = document.getElementById('faq-accordion');
            faqAccordion.innerHTML = appData.faqs.map((faq, index) => `
                <div class="accordion-item" style="margin-bottom: 15px; border-bottom: 1px solid var(--light-gray); padding-bottom: 15px;">
                    <div class="accordion-header" style="font-weight: 600; cursor: pointer; display: flex; justify-content: space-between;">
                        <span>${faq.question}</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="accordion-content" style="margin-top: 10px; display: none;">
                        ${faq.answer}
                    </div>
                </div>
            `).join('');

            // Set up accordion functionality
            const accordionHeaders = document.querySelectorAll('.accordion-header');
            accordionHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    const content = this.nextElementSibling;
                    const icon = this.querySelector('i');
                    
                    if (content.style.display === 'none') {
                        content.style.display = 'block';
                        icon.classList.remove('fa-chevron-down');
                        icon.classList.add('fa-chevron-up');
                    } else {
                        content.style.display = 'none';
                        icon.classList.remove('fa-chevron-up');
                        icon.classList.add('fa-chevron-down');
                    }
                });
            });
        }

        // Helper functions
        function applyTheme() {
            // Apply primary color
            document.documentElement.style.setProperty('--primary', appData.settings.themeColor);

            // Apply dark mode
            if (appData.settings.darkMode) {
                document.documentElement.style.setProperty('--light', '#1a1a1a');
                document.documentElement.style.setProperty('--white', '#2a2a2a');
                document.documentElement.style.setProperty('--dark', '#f5f5f5');
                document.documentElement.style.setProperty('--light-gray', '#444');
            } else {
                document.documentElement.style.setProperty('--light', '#f5f5f5');
                document.documentElement.style.setProperty('--white', '#ffffff');
                document.documentElement.style.setProperty('--dark', '#333');
                document.documentElement.style.setProperty('--light-gray', '#e0e0e0');
            }
        }

        function updateQRCode(data) {
            const qrCodeImage = document.getElementById('qr-code-image');
            qrCodeImage.src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(data)}`;
        }

        function renderProducts(products) {
            const productGrid = document.getElementById('product-grid');
            productGrid.innerHTML = products.map(product => `
                <div class="product-card">
                    <div class="product-image">
                        <img src="https://via.placeholder.com/150" alt="${product.name}">
                        ${product.badge ? `<span class="product-badge">${product.badge}</span>` : ''}
                    </div>
                    <div class="product-content">
                        <h3 class="product-title">${product.name}</h3>
                        <p class="product-category">${product.category} • ${product.description}</p>
                        <div class="product-price">
                            <span class="price-retail">$${product.retailPrice.toFixed(2)}</span>
                            <span class="price-discount">$${product.discountPrice.toFixed(2)} (${Math.round((1 - product.discountPrice / product.retailPrice) * 100)}% desc.)</span>
                            <span class="price-doctor">Precio médico: $${product.doctorPrice.toFixed(2)}</span>
                        </div>
                        <div class="product-actions">
                            <button class="btn btn-sm btn-outline view-product-btn" data-id="${product.id}">
                                <i class="fas fa-info-circle"></i> Detalles
                            </button>
                            <button class="btn btn-sm btn-primary buy-product-btn" data-id="${product.id}">
                                <i class="fas fa-cart-plus"></i> Comprar
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterProducts() {
            const searchTerm = document.getElementById('product-search').value.toLowerCase();
            const category = document.getElementById('product-category').value;
            const sort = document.getElementById('product-sort').value;
            const pharmacy = document.getElementById('product-pharmacy').value;

            let filteredProducts = [...appData.products];

            // Apply filters
            if (searchTerm) {
                filteredProducts = filteredProducts.filter(product => 
                    product.name.toLowerCase().includes(searchTerm) || 
                    product.category.toLowerCase().includes(searchTerm)
                );
            }

            if (category) {
                filteredProducts = filteredProducts.filter(product => product.category === category);
            }

            if (pharmacy) {
                filteredProducts = filteredProducts.filter(product => product.pharmacy === pharmacy);
            }

            // Apply sorting
            switch (sort) {
                case 'price-low':
                    filteredProducts.sort((a, b) => a.doctorPrice - b.doctorPrice);
                    break;
                case 'price-high':
                    filteredProducts.sort((a, b) => b.doctorPrice - a.doctorPrice);
                    break;
                case 'name-asc':
                    filteredProducts.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'name-desc':
                    filteredProducts.sort((a, b) => b.name.localeCompare(a.name));
                    break;
                case 'popular':
                default:
                    // Default sorting (by popularity)
                    filteredProducts.sort((a, b) => {
                        const aPrescriptions = appData.popularProducts.find(p => p.name === a.name)?.prescriptions || 0;
                        const bPrescriptions = appData.popularProducts.find(p => p.name === b.name)?.prescriptions || 0;
                        return bPrescriptions - aPrescriptions;
                    });
                    break;
            }

            renderProducts(filteredProducts);
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast show ${type}`;
            
            setTimeout(() => {
                toast.className = 'toast';
            }, 3000);
        }

        // Event listeners setup
        function setupEventListeners() {
            // Tab functionality
            const menuLinks = document.querySelectorAll('.menu-link');
            menuLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all menu links and tab contents
                    menuLinks.forEach(l => l.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Add active class to clicked menu link
                    this.classList.add('active');
                    
                    // Show corresponding tab content
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Inner tabs (like in dashboard)
            const innerTabs = document.querySelectorAll('.tab-container .tab');
            innerTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabContainer = this.closest('.tab-container');
                    
                    // Remove active class from all tabs in this container
                    tabContainer.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    tabContainer.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Show corresponding tab content
                    const tabId = this.getAttribute('data-tab');
                    tabContainer.querySelector(`#${tabId}`).classList.add('active');
                });
            });
            
            // QR Generator form
            document.getElementById('qr-generator-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const patientName = document.getElementById('patient-name').value;
                const patientEmail = document.getElementById('patient-email').value;
                const patientPhone = document.getElementById('patient-phone').value;
                
                if (!patientName) {
                    showToast('Por favor ingrese el nombre del paciente', 'danger');
                    return;
                }
                
                // Generate QR code
                const qrData = `https://farmabien.com/mediclub/desc/5/${appData.user.id}/${Date.now()}`;
                updateQRCode(qrData);
                
                // Add to history
                const newQR = {
                    date: new Date().toLocaleDateString(),
                    patient: patientName,
                    contact: patientEmail || patientPhone || 'N/A',
                    status: 'No usado',
                    token: 0
                };
                
                appData.qrHistory.unshift(newQR);
                saveDataToStorage();
                
                // Update table
                const qrHistoryTable = document.querySelector('#qr-history-table tbody');
                qrHistoryTable.innerHTML = appData.qrHistory.map(item => `
                    <tr>
                        <td>${item.date}</td>
                        <td>${item.patient}</td>
                        <td>${item.contact}</td>
                        <td><span class="badge ${item.status === 'Usado' ? 'badge-success' : 'badge-danger'}">${item.status}</span></td>
                        <td><span class="badge ${item.token > 0 ? 'badge-success' : 'badge-danger'}">${item.token > 0 ? '+' + item.token : item.token}</span></td>
                    </tr>
                `).join('');
                
                showToast('Código QR generado exitosamente');
            });
            
            // Send QR by email
            document.getElementById('send-email-btn').addEventListener('click', function() {
                const patientEmail = document.getElementById('patient-email').value;
                if (!patientEmail) {
                    showToast('Por favor ingrese un email para enviar el QR', 'danger');
                    return;
                }
                showToast(`QR enviado por email a ${patientEmail}`);
            });
            
            // Send QR by WhatsApp
            document.getElementById('send-whatsapp-btn').addEventListener('click', function() {
                const patientPhone = document.getElementById('patient-phone').value;
                if (!patientPhone) {
                    showToast('Por favor ingrese un teléfono para enviar el QR', 'danger');
                    return;
                }
                showToast(`QR enviado por WhatsApp a ${patientPhone}`);
            });
            
            // Download QR
            document.getElementById('download-qr-btn').addEventListener('click', function() {
                showToast('QR descargado exitosamente');
            });
            
            // Prescription form toggle
            document.getElementById('new-prescription-btn').addEventListener('click', function() {
                document.getElementById('prescription-list').style.display = 'none';
                document.getElementById('new-prescription').style.display = 'block';
            });
            
            document.getElementById('cancel-prescription').addEventListener('click', function() {
                document.getElementById('prescription-list').style.display = 'block';
                document.getElementById('new-prescription').style.display = 'none';
            });
            
            // Add prescription item
            document.getElementById('add-prescription-item').addEventListener('click', function() {
                const newItem = document.createElement('div');
                newItem.className = 'prescription-item';
                newItem.innerHTML = `
                    <select class="form-control" name="medication" required>
                        <option value="">Seleccione medicamento</option>
                        <option value="1">Atorvastatina 20mg</option>
                        <option value="2">Losartán 50mg</option>
                        <option value="3">Metformina 850mg</option>
                        <option value="4">Omeprazol 20mg</option>
                        <option value="5">Amlodipino 5mg</option>
                    </select>
                    <input type="text" class="form-control" name="dosage" placeholder="Dosis" required>
                    <input type="text" class="form-control" name="frequency" placeholder="Frecuencia" required>
                    <input type="text" class="form-control" name="duration" placeholder="Duración" required>
                    <div class="remove-item">
                        <i class="fas fa-times"></i>
                    </div>
                `;
                
                const container = document.getElementById('prescription-items-container');
                const addButton = document.getElementById('add-prescription-item');
                container.insertBefore(newItem, addButton);
                
                // Add event listener to new remove button
                newItem.querySelector('.remove-item').addEventListener('click', function() {
                    newItem.remove();
                });
            });
            
            // Remove prescription item
            document.querySelectorAll('.remove-item').forEach(item => {
                item.addEventListener('click', function() {
                    this.closest('.prescription-item').remove();
                });
            });
            
            // Signature pad functionality
            const canvas = document.querySelector('#signature-pad canvas');
            if (canvas) {
                const ctx = canvas.getContext('2d');
                let isDrawing = false;
                let lastX = 0;
                let lastY = 0;
                
                // Set up drawing properties
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';
                
                // Drawing functions
                canvas.addEventListener('mousedown', startDrawing);
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', stopDrawing);
                canvas.addEventListener('mouseout', stopDrawing);
                
                // Touch support
                canvas.addEventListener('touchstart', handleTouchStart);
                canvas.addEventListener('touchmove', handleTouchMove);
                canvas.addEventListener('touchend', handleTouchEnd);
                
                function startDrawing(e) {
                    isDrawing = true;
                    [lastX, lastY] = getPosition(e);
                }
                
                function draw(e) {
                    if (!isDrawing) return;
                    
                    ctx.beginPath();
                    ctx.moveTo(lastX, lastY);
                    [lastX, lastY] = getPosition(e);
                    ctx.lineTo(lastX, lastY);
                    ctx.stroke();
                }
                
                function stopDrawing() {
                    isDrawing = false;
                }
                
                function getPosition(e) {
                    const rect = canvas.getBoundingClientRect();
                    let x, y;
                    
                    if (e.type.includes('touch')) {
                        x = e.touches[0].clientX - rect.left;
                        y = e.touches[0].clientY - rect.top;
                    } else {
                        x = e.clientX - rect.left;
                        y = e.clientY - rect.top;
                    }
                    
                    return [x, y];
                }
                
                // Touch handlers
                function handleTouchStart(e) {
                    e.preventDefault();
                    startDrawing(e.touches[0]);
                }
                
                function handleTouchMove(e) {
                    e.preventDefault();
                    draw(e.touches[0]);
                }
                
                function handleTouchEnd(e) {
                    e.preventDefault();
                    stopDrawing();
                }
                
                // Clear button
                document.getElementById('clear-signature').addEventListener('click', function() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    document.getElementById('signature-preview').style.display = 'none';
                    appData.user.signature = null;
                    saveDataToStorage();
                });
                
                // Save button
                document.getElementById('save-signature').addEventListener('click', function() {
                    const dataUrl = canvas.toDataURL();
                    document.getElementById('signature-preview').querySelector('img').src = dataUrl;
                    document.getElementById('signature-preview').style.display = 'block';
                    appData.user.signature = dataUrl;
                    saveDataToStorage();
                    showToast('Firma guardada exitosamente');
                });
            }
            
            // Submit prescription form
            document.getElementById('prescription-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Validate form
                const patientName = document.getElementById('prescription-patient-name').value;
                const patientPhone = document.getElementById('prescription-patient-phone').value;
                
                if (!patientName || !patientPhone) {
                    showToast('Por favor complete los campos requeridos', 'danger');
                    return;
                }
                
                // Count medication items
                const medicationItems = document.querySelectorAll('.prescription-item');
                if (medicationItems.length === 0) {
                    showToast('Por favor agregue al menos un medicamento', 'danger');
                    return;
                }
                
                // Check signature
                if (!appData.user.signature) {
                    showToast('Por favor guarde su firma digital', 'danger');
                    return;
                }
                
                // Create new prescription
                const newPrescription = {
                    date: new Date().toLocaleDateString(),
                    number: `RX-${new Date().getFullYear()}-${String(appData.prescriptions.length + 1).padStart(5, '0')}`,
                    patient: patientName,
                    items: medicationItems.length,
                    status: 'Pendiente'
                };
                
                appData.prescriptions.unshift(newPrescription);
                appData.user.prescriptions++;
                saveDataToStorage();
                
                // Update UI
                document.getElementById('prescription-list').style.display = 'block';
                document.getElementById('new-prescription').style.display = 'none';
                
                // Reset form
                this.reset();
                document.querySelector('#signature-pad canvas').getContext('2d').clearRect(0, 0, 400, 200);
                document.getElementById('signature-preview').style.display = 'none';
                
                // Update prescriptions table
                const prescriptionsTable = document.querySelector('#prescriptions-table tbody');
                prescriptionsTable.innerHTML = appData.prescriptions.map(prescription => `
                    <tr>
                        <td>${prescription.date}</td>
                        <td>${prescription.number}</td>
                        <td>${prescription.patient}</td>
                        <td>${prescription.items}</td>
                        <td><span class="badge ${prescription.status === 'Entregada' ? 'badge-success' : 'badge-secondary'}">${prescription.status}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline view-prescription-btn" data-id="${prescription.number}">
                                <i class="fas fa-eye"></i> Ver
                            </button>
                        </td>
                    </tr>
                `).join('');
                
                showToast('Receta creada exitosamente');
            });
            
            // View prescription
            document.addEventListener('click', function(e) {
                if (e.target.closest('.view-prescription-btn')) {
                    const prescriptionId = e.target.closest('.view-prescription-btn').getAttribute('data-id');
                    const prescription = appData.prescriptions.find(p => p.number === prescriptionId);
                    
                    if (prescription) {
                        alert(`Mostrando receta ${prescription.number} para ${prescription.patient}`);
                    }
                }
            });
            
            // Buy product
            document.addEventListener('click', function(e) {
                if (e.target.closest('.buy-product-btn')) {
                    const productId = e.target.closest('.buy-product-btn').getAttribute('data-id');
                    const product = appData.products.find(p => p.id == productId);
                    
                    if (product) {
                        showToast(`${product.name} agregado al carrito`);
                    }
                }
            });
            
            // View product details
            document.addEventListener('click', function(e) {
                if (e.target.closest('.view-product-btn')) {
                    const productId = e.target.closest('.view-product-btn').getAttribute('data-id');
                    const product = appData.products.find(p => p.id == productId);
                    
                    if (product) {
                        alert(`Detalles de ${product.name}\nCategoría: ${product.category}\nPrecio médico: $${product.doctorPrice.toFixed(2)}`);
                    }
                }
            });
            
            // Copy referral link
            document.getElementById('copy-referral-link').addEventListener('click', function() {
                const referralLink = document.getElementById('referral-link');
                referralLink.select();
                document.execCommand('copy');
                
                // Show tooltip
                showToast('Enlace copiado al portapapeles');
            });
            
            // Send referral by email
            document.getElementById('send-referral-email').addEventListener('click', function() {
                showToast('Invitación enviada por email');
            });
            
            // Send referral by WhatsApp
            document.getElementById('send-referral-whatsapp').addEventListener('click', function() {
                showToast('Invitación enviada por WhatsApp');
            });
            
            // Download referral QR
            document.getElementById('download-referral-qr').addEventListener('click', function() {
                showToast('QR de referido descargado');
            });
            
            // Invite doctor
            document.getElementById('invite-doctor-btn').addEventListener('click', function() {
                const doctorName = prompt('Ingrese el nombre del médico que desea invitar:');
                if (doctorName) {
                    const newDoctor = {
                        name: doctorName,
                        specialty: prompt('Ingrese la especialidad del médico:') || 'No especificada',
                        date: new Date().toLocaleDateString(),
                        status: 'Pendiente',
                        tokens: 0
                    };
                    
                    appData.referredDoctors.unshift(newDoctor);
                    saveDataToStorage();
                    
                    // Update table
                    const referredDoctorsTable = document.querySelector('#referred-doctors-table tbody');
                    referredDoctorsTable.innerHTML = appData.referredDoctors.map(doctor => `
                        <tr>
                            <td>${doctor.name}</td>
                            <td>${doctor.specialty}</td>
                            <td>${doctor.date}</td>
                            <td><span class="badge ${doctor.status === 'Activo' ? 'badge-success' : 'badge-secondary'}">${doctor.status}</span></td>
                            <td><span class="badge ${doctor.tokens > 0 ? 'badge-success' : 'badge-danger'}">${doctor.tokens > 0 ? '+' + doctor.tokens : doctor.tokens}</span></td>
                        </tr>
                    `).join('');
                    
                    showToast(`Invitación enviada a ${doctorName}`);
                }
            });
            
            // Redeem tokens
            document.getElementById('redeem-tokens-btn').addEventListener('click', function() {
                const tokensToRedeem = prompt(`Tienes ${appData.user.tokens} tokens (1 token = $1 USD). ¿Cuántos deseas canjear?`, '10');
                
                if (tokensToRedeem && !isNaN(tokensToRedeem)) {
                    const tokens = parseInt(tokensToRedeem);
                    
                    if (tokens <= 0) {
                        showToast('Por favor ingrese un número positivo', 'danger');
                        return;
                    }
                    
                    if (tokens > appData.user.tokens) {
                        showToast('No tienes suficientes tokens', 'danger');
                        return;
                    }
                    
                    appData.user.tokens -= tokens;
                    appData.tokenHistory.unshift({
                        date: new Date().toLocaleDateString(),
                        description: `Canje de ${tokens} tokens`,
                        tokens: -tokens,
                        balance: appData.user.tokens
                    });
                    
                    saveDataToStorage();
                    
                    // Update UI
                    document.getElementById('token-balance').textContent = appData.user.tokens;
                    
                    const tokenHistoryTable = document.querySelector('#token-history-table tbody');
                    tokenHistoryTable.innerHTML = appData.tokenHistory.map(item => `
                        <tr>
                            <td>${item.date}</td>
                            <td>${item.description}</td>
                            <td><span class="badge ${item.tokens > 0 ? 'badge-success' : 'badge-danger'}">${item.tokens > 0 ? '+' + item.tokens : item.tokens}</span></td>
                            <td>${item.balance}</td>
                        </tr>
                    `).join('');
                    
                    showToast(`${tokens} tokens canjeados exitosamente`);
                }
            });
            
            // Save account changes
            document.getElementById('account-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                appData.user.firstName = document.getElementById('first-name').value;
                appData.user.lastName = document.getElementById('last-name').value;
                appData.user.specialty = document.getElementById('specialty').value;
                appData.user.email = document.getElementById('email').value;
                appData.user.phone = document.getElementById('phone').value;
                appData.user.address = document.getElementById('address').value;
                
                saveDataToStorage();
                showToast('Información actualizada exitosamente');
            });
            
            // Change password
            document.getElementById('security-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const currentPassword = document.getElementById('current-password').value;
                const newPassword = document.getElementById('new-password').value;
                const confirmPassword = document.getElementById('confirm-password').value;
                
                if (!currentPassword || !newPassword || !confirmPassword) {
                    showToast('Por favor complete todos los campos', 'danger');
                    return;
                }
                
                if (newPassword !== confirmPassword) {
                    showToast('Las contraseñas no coinciden', 'danger');
                    return;
                }
                
                // In a real app, you would validate the current password and update it
                showToast('Contraseña cambiada exitosamente');
                this.reset();
            });
            
            // Download personal QR
            document.getElementById('download-personal-qr').addEventListener('click', function() {
                showToast('QR personal descargado');
            });
            
            // Print personal QR
            document.getElementById('print-personal-qr').addEventListener('click', function() {
                showToast('Preparando QR para impresión...');
                // In a real app, this would open the print dialog
            });
            
            // Save notification settings
            document.getElementById('notifications-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                appData.settings.notifications.email = document.getElementById('email-notifications').checked;
                appData.settings.notifications.sms = document.getElementById('sms-notifications').checked;
                appData.settings.notifications.push = document.getElementById('push-notifications').checked;
                appData.settings.notifications.tokens = document.getElementById('notif-tokens').checked;
                appData.settings.notifications.referrals = document.getElementById('notif-referrals').checked;
                appData.settings.notifications.prescriptions = document.getElementById('notif-prescriptions').checked;
                appData.settings.notifications.promotions = document.getElementById('notif-promotions').checked;
                
                saveDataToStorage();
                showToast('Configuración de notificaciones guardada');
            });
            
            // Save privacy settings
            document.getElementById('privacy-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                appData.settings.privacy.profileVisibility = document.querySelector('input[name="profile-visibility"]:checked').value;
                appData.settings.privacy.dataSharing = document.querySelector('input[name="data-sharing"]:checked').value;
                
                saveDataToStorage();
                showToast('Configuración de privacidad guardada');
            });
            
            // Submit help form
            document.getElementById('help-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const subject = document.getElementById('help-subject').value;
                const message = document.getElementById('help-message').value;
                
                if (!subject || !message) {
                    showToast('Por favor complete todos los campos', 'danger');
                    return;
                }
                
                showToast('Mensaje enviado al equipo de soporte');
                this.reset();
            });
            
            // Logout
            document.getElementById('logout-btn').addEventListener('click', function(e) {
                e.preventDefault();
                if (confirm('¿Estás seguro que deseas cerrar sesión?')) {
                    // In a real app, this would redirect to the login page
                    showToast('Sesión cerrada exitosamente');
                }
            });
        }
    </script>
</body>
</html>